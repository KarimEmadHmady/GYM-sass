# ๐ฏ ูุธุงู ููุงุท ุงูููุงุก (Loyalty Points System)

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ููุงุท ุงูููุงุก ูู ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ููุงุท ุงูุนููุงุก ูู ุงูุฌููุ ุญูุซ ูููู ููุนููุงุก ูุณุจ ููุงุท ูู ุฎูุงู ุงููุฏููุนุงุช ูุงูุญุถูุฑ ูุงุณุชุจุฏุงููุง ุจููุงูุขุช ูุฎุชููุฉ.

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### ุงููููุงุช ุงููุถุงูุฉ:
- `src/services/loyaltyPoints.service.js` - ููุทู ุงูุฃุนูุงู
- `src/controllers/loyaltyPoints.controller.js` - ุงูุชุญูู ูู ุงูุทูุจุงุช
- `src/routes/loyaltyPoints.routes.js` - ูุณุงุฑุงุช API
- `src/validators/loyaltyPoints.validator.js` - ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช

### ุงููููุงุช ุงููุญุฏุซุฉ:
- `src/services/payment.service.js` - ุฅุถุงูุฉ ููุงุท ุชููุงุฆูุงู ุนูุฏ ุงูุฏูุน
- `src/services/attendanceRecords.service.js` - ุฅุถุงูุฉ ููุงุท ุชููุงุฆูุงู ุนูุฏ ุงูุญุถูุฑ
- `server.js` - ุฅุถุงูุฉ routes ุงูุฌุฏูุฏุฉ

---

## ๐ฎ ููุงุนุฏ ูุณุจ ุงูููุงุท

### 1. ููุงุท ุงููุฏููุนุงุช
- **ูู 10 ุฌููู = ููุทุฉ ูุงุญุฏุฉ**
- ูุชู ุฅุถุงูุฉ ุงูููุงุท ุชููุงุฆูุงู ุนูุฏ ุฅูุดุงุก ุฃู ุฏูุนุฉ
- ูุซุงู: ุฏูุน 150 ุฌููู = 15 ููุทุฉ

### 2. ููุงุท ุงูุญุถูุฑ
- **ุญุถูุฑ ุงูููู = 5 ููุงุท**
- **ุญุถูุฑ 3 ุฃูุงู ูุชุชุงููุฉ = 20 ููุทุฉ**
- **ุญุถูุฑ ุฃุณุจูุน ูุชุชุงูู = 50 ููุทุฉ**

### 3. ููุงุท ุฅุถุงููุฉ (ูุฏููุงู)
- ูููู ูููุฏูุฑ ุฅุถุงูุฉ ููุงุท ูุฏููุงู ูุฃู ุณุจุจ
- ูุซุงู: ููุงูุฃุฉ ุฎุงุตุฉุ ุนูุฏ ูููุงุฏุ ุฅูุฎ

---

## ๐ง API Endpoints

### ุฌูุจ ููุงุท ุงููุณุชุฎุฏู
```http
GET /api/loyalty-points/my-points
GET /api/loyalty-points/user/:userId
```

### ุฅุถุงูุฉ ููุงุท (ูููุฏูุฑ ููุท)
```http
POST /api/loyalty-points/add
Content-Type: application/json

{
  "userId": "user_id_here",
  "points": 50,
  "reason": "ููุงูุฃุฉ ุฎุงุตุฉ"
}
```

### ุงุณุชุจุฏุงู ููุงุท
```http
POST /api/loyalty-points/redeem
Content-Type: application/json

{
  "userId": "user_id_here",
  "points": 100,
  "reward": "ุฌูุณุฉ ุชุฏุฑูุจ ูุฌุงููุฉ"
}
```

### ุฅุญุตุงุฆูุงุช ุงูููุงุท (ูููุฏูุฑ ููุท)
```http
GET /api/loyalty-points/stats
```

### ุฃูุถู ุงููุณุชุฎุฏููู
```http
GET /api/loyalty-points/top-users?limit=10
```

### ุฅุถุงูุฉ ููุงุท ูู ุงูุฏูุน (ูููุฏูุฑ ููุท)
```http
POST /api/loyalty-points/payment-points
Content-Type: application/json

{
  "userId": "user_id_here",
  "amount": 200,
  "paymentType": "ุฏูุน ุงุดุชุฑุงู ุดูุฑู"
}
```

### ุฅุถุงูุฉ ููุงุท ุงูุญุถูุฑ (ูููุฏูุฑ ูุงููุฏุฑุจ)
```http
POST /api/loyalty-points/attendance-points
Content-Type: application/json

{
  "userId": "user_id_here",
  "attendanceStreak": 7
}
```

---

## ๐ ุงูุตูุงุญูุงุช

### ุงููุฏูุฑ (Admin)
- โ ุฅุถุงูุฉ ููุงุท ูุฏููุงู
- โ ุงุณุชุจุฏุงู ููุงุท
- โ ุฌูุจ ุงูุฅุญุตุงุฆูุงุช
- โ ุฅุถุงูุฉ ููุงุท ูู ุงูุฏูุน
- โ ุฅุถุงูุฉ ููุงุท ุงูุญุถูุฑ

### ุงููุฏุฑุจ (Trainer)
- โ ุฅุถุงูุฉ ููุงุท ุงูุญุถูุฑ
- โ ุฌูุจ ููุงุท ุนููุงุฆู

### ุงูุนุถู (Member)
- โ ุฑุคูุฉ ููุงุทู
- โ ุงุณุชุจุฏุงู ููุงุทู
- โ ุฌูุจ ุณุฌู ููุงุทู

---

## ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุฌุฏูู ุงููุณุชุฎุฏููู (Users)
```javascript
{
  loyaltyPoints: { type: Number, default: 0 }
}
```

### ุฌุฏูู ุงูููุงูุขุช (Rewards)
```javascript
{
  userId: ObjectId,
  points: Number, // ููุฌุจ ููุฅุถุงูุฉุ ุณุงูุจ ููุงุณุชุจุฏุงู
  redeemedFor: String, // ุณุจุจ ุงูุฅุถุงูุฉ ุฃู ุงูููุงูุฃุฉ ุงููุณุชุจุฏูุฉ
  date: Date
}
```

---

## ๐ ุงูุชูุงูู ุงูุชููุงุฆู

### 1. ูุน ูุธุงู ุงููุฏููุนุงุช
- ุนูุฏ ุฅูุดุงุก ุฃู ุฏูุนุฉุ ูุชู ุญุณุงุจ ุงูููุงุท ุชููุงุฆูุงู
- ูู 10 ุฌููู = ููุทุฉ ูุงุญุฏุฉ
- ูุชู ุชุณุฌูู ุงูุนูููุฉ ูู ุฌุฏูู Rewards

### 2. ูุน ูุธุงู ุงูุญุถูุฑ
- ุนูุฏ ุชุณุฌูู ุงูุญุถูุฑุ ูุชู ุญุณุงุจ ุงูููุงุท ุชููุงุฆูุงู
- ูุชู ุญุณุงุจ ุนุฏุฏ ุฃูุงู ุงูุญุถูุฑ ุงููุชุชุงููุฉ
- ูุชู ุฅุถุงูุฉ ุงูููุงุท ุญุณุจ ุงูููุงุนุฏ ุงููุญุฏุฏุฉ

---

## ๐ก๏ธ ุงูุฃูุงู ูุงูุชุญูู

### ุงูุชุญูู ูู ุงูุจูุงูุงุช
- ุฌููุน ุงููุฏุฎูุงุช ูุชู ุงูุชุญูู ูููุง ุจุงุณุชุฎุฏุงู Joi
- ุงูุชุญูู ูู ูุฌูุฏ ุงููุณุชุฎุฏู
- ุงูุชุญูู ูู ููุงูุฉ ุงูููุงุท ููุงุณุชุจุฏุงู

### ุงูุตูุงุญูุงุช
- ุงุณุชุฎุฏุงู middleware ููุชุญูู ูู ุงูุตูุงุญูุงุช
- ูู endpoint ูู ุตูุงุญูุงุช ูุญุฏุฏุฉ
- ุงูุชุญูู ูู ุฏูุฑ ุงููุณุชุฎุฏู

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงููุชุงุญุฉ

### ุฅุญุตุงุฆูุงุช ุนุงูุฉ
- ุฅุฌูุงูู ุงูููุงุท ูู ุงููุธุงู
- ุนุฏุฏ ุงููุณุชุฎุฏููู
- ูุชูุณุท ุงูููุงุท ููู ูุณุชุฎุฏู
- ุฃุนูู ููุงุท ูู ุงููุธุงู

### ุฃูุถู ุงููุณุชุฎุฏููู
- ูุงุฆูุฉ ุจุฃูุถู 10 ูุณุชุฎุฏููู ูู ุงูููุงุท
- ูููู ุชุญุฏูุฏ ุนุฏุฏ ุงููุชุงุฆุฌ

---

## ๐ ุงูุงุณุชุฎุฏุงู

### 1. ุชุซุจูุช ุงูุชุจุนูุงุช
```bash
npm install
```

### 2. ุชุดุบูู ุงูุฎุงุฏู
```bash
npm start
```

### 3. ุงุฎุชุจุงุฑ API
```bash
# ุฌูุจ ููุงุท ุงููุณุชุฎุฏู
curl -H "Authorization: Bearer YOUR_TOKEN" \
     http://localhost:3000/api/loyalty-points/my-points

# ุฅุถุงูุฉ ููุงุท (ูููุฏูุฑ)
curl -X POST \
     -H "Authorization: Bearer ADMIN_TOKEN" \
     -H "Content-Type: application/json" \
     -d '{"userId":"user_id","points":50,"reason":"ููุงูุฃุฉ"}' \
     http://localhost:3000/api/loyalty-points/add
```

---

## ๐ง ุงูุชุฎุตูุต

### ุชุบููุฑ ููุงุนุฏ ุงูููุงุท
ูููู ุชุนุฏูู ููุงุนุฏ ุงูููุงุท ูู `loyaltyPoints.service.js`:

```javascript
// ุชุบููุฑ ูุณุจุฉ ุงูููุงุท ูู ุงููุฏููุนุงุช
export const calculatePointsFromPayment = (amount) => {
  return Math.floor(amount / 5); // ูู 5 ุฌููู = ููุทุฉ ูุงุญุฏุฉ
};

// ุชุบููุฑ ููุงุท ุงูุญุถูุฑ
export const addAttendancePoints = async (userId, attendanceStreak) => {
  let points = 0;
  if (attendanceStreak >= 7) {
    points = 100; // ุชุบููุฑ ูู 50 ุฅูู 100
  }
  // ...
};
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ูุดุงูู ุดุงุฆุนุฉ:
1. **ุฎุทุฃ ูู ุฅุถุงูุฉ ุงูููุงุท**: ุชุฃูุฏ ูู ูุฌูุฏ ุงููุณุชุฎุฏู
2. **ุฎุทุฃ ูู ุงูุงุณุชุจุฏุงู**: ุชุฃูุฏ ูู ููุงูุฉ ุงูููุงุท
3. **ุฎุทุฃ ูู ุงูุตูุงุญูุงุช**: ุชุฃูุฏ ูู ุฏูุฑ ุงููุณุชุฎุฏู

### ุณุฌูุงุช ุงูุฃุฎุทุงุก:
- ูุชู ุชุณุฌูู ุฃุฎุทุงุก ุฅุถุงูุฉ ุงูููุงุท ูู console
- ูุง ุชููู ุงูุนูููุฉ ุงูุฑุฆูุณูุฉ ุฅุฐุง ูุดูุช ุฅุถุงูุฉ ุงูููุงุท

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุชุฒุงูู**: ุงูููุงุท ุชุชุฒุงูู ูุน ุฌุฏูู Rewards
2. **ุงูุฃูุงู**: ุฌููุน ุงูุนูููุงุช ูุญููุฉ ุจุงูุตูุงุญูุงุช
3. **ุงูุฃุฏุงุก**: ุงุณุชุฎุฏุงู indexes ููุงุณุชุนูุงูุงุช ุงูุณุฑูุนุฉ
4. **ุงููุฑููุฉ**: ูููู ุชุฎุตูุต ููุงุนุฏ ุงูููุงุท ุจุณูููุฉ

---

## ๐ค ุงููุณุงููุฉ

ูุฅุถุงูุฉ ููุฒุงุช ุฌุฏูุฏุฉ ุฃู ุชุญุณูู ุงููุธุงู:
1. ุฅูุดุงุก branch ุฌุฏูุฏ
2. ุฅุถุงูุฉ ุงูููุฒุฉ ูุน ุงูุงุฎุชุจุงุฑุงุช
3. ุฅูุดุงุก Pull Request
4. ูุฑุงุฌุนุฉ ุงูููุฏ ูุงูููุงููุฉ

---

## ๐ ุงูุฏุนู

ูุฃู ุงุณุชูุณุงุฑุงุช ุฃู ูุดุงูู:
- ุฅูุดุงุก Issue ูู GitHub
- ุงูุชูุงุตู ูุน ูุฑูู ุงูุชุทููุฑ
- ูุฑุงุฌุนุฉ ุงูุชูุซูู ุฃููุงู
